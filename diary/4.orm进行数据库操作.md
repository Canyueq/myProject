# 1.27

## CRUD

### Select

通过select("username")可以查询具体字段，如果不写就查询*

### Find

[1] 查询数据库结果 &{0xc0000d0ab0 <nil> 0 0xc000106380 0}

### First

[1] 查询数据库结果 &{0xc00014cab0 record not found 0 0xc000106fc0 0}

### 对于查询First更好，Find只有报错才会返回非nil的值

### First才会返回结果

### 不管是nil还是not found都是通过.Error访问

用户名不存在通过First.Error返回是这个，
[1] 查询结果 record not found
存在返回的结果是

nil

### .RowsAffected

返回查询的结果数量

### 查询返回的字段值会映射在作为参数的那个结构体上例如&user

### Create

创建时如果存在

[1] 查询结果 错误: 重复键违反唯一约束"user_pkey" (SQLSTATE 23505)

如果不存在，也就是顺利创建

nil

## CSS+TS对元素样式进行操作

### 获取元素

通过element = document.getElementByClassName("classname")可以获取到对应的元素

> **`getElementsByClassName` 返回的是一个 `HTMLCollection`（类数组），不是真正的数组，且它是「动态实时更新」的。**

而你可能在 **元素尚未渲染完成时** 就尝试访问它，导致 `HTMLCollection` 为空，从而通过下标访问失败。

#### 通过id访问的是唯一标识，所以不会出现这种情况

getElementById获取id同理

### 获取具体属性

通过hight = element.offSetHeight可以获取到具体的高度

### 设置属性

document.documentElement.style.setProperty("--prop",height+"px")进行具体属性的设置

# JWT

JWT(JSONWebToken)是一种是一种开放标准（RFC 7519），用于在不同方之间以 JSON 对象的形式安全地传递信息。JWT 是目前最流行的跨域认证解决方案，广泛用于用户认证和信息交换

包含三个部分：Header.Payload.Signature

```
GenerateJWT 生成 JWT Token，包含用户 ID 和用户名，有效期 24 小时
使用 HS256 签名算法，密钥为 "can-yue"（生产环境应从环境变量读取）
```

登录和注册接口不用绑定jwt中间件,因为需要通过登录才能获取token

### 由于页面刷新会丢失用户信息，选择每次刷新通过凭借token访问后端接口，再重新返回数据

那我后端怎么知道应该返回什么数据给前端，一定是token里携带了某种信息，考虑到之前存入了id和username到jwt里面，很容易想到，可以通过解密这两个信息，返回给前端，甚至只需要id就足以。可以通过查询数据库的方式找到username再返回给前端仅仅多了一步而已，但是安全性更高

### 具体操作

前端通过请求拦截器给每次请求添加上token

![](C:\Users\canyue\AppData\Roaming\marktext\images\2026-01-27-21-12-39-image.png)

后端通过jwt中间体对token进行解析和验证，并储存到gin的上下文

![](C:\Users\canyue\AppData\Roaming\marktext\images\2026-01-27-21-28-20-image.png)

前端请求拦截器,拼接中间只能有一个空字符

![](C:\Users\canyue\AppData\Roaming\marktext\images\2026-01-27-22-16-52-image.png)
